# GAPS

Graph-based Automated Path Sythesizer

## Instructions

Install requirements

`pip install -r requirements.txt`

and install `apktool` and `baksmali` (if interested in only DEX analysis) in your PATH

Run the wrapper script

`./run.sh <args>`

## Command line arguments

-   -i, apk/dex input (mandatory)

-   -m, specify target method to build paths from

-   -cls, specify target class for target method

-   -parent_class, name of the class that will contain the target method invocation

-   -sig, specifty target method signature in smali format and build paths for it

-   -seed, specify seed file containing smali signatures to direct search

-   -output, path to the directory that will store the results

-   -cond, generate paths that satisfy conditional statements

-   -path_limit, set an upperbound to the total number of paths reconstructed for each query (default 1000)

-   -unconstrained_paths, do not set an upperbound to the total number of paths reconstructed

-   -d, print debug output

-   -v, print verbose output

## Example usage

`./run.sh -i <app-path> -cond -m <target-method> -o <output_dir>`

If no search direction is given (i.e., target method, target class and signature are not specified), a seed file is generated automatically by randomly selecting 50 methods in the app's package name.

# GAPS Automatic Interaction

Use `gaps_run.py` with a real or emulated device to reproduce the paths reconstructed.
If device is rooted and equipped with Frida, a Proof-of-Reachability can be obtained.

The modified copy of Guardian is also included in this repository.

## Instructions

Run the python script

`python3 gaps_run.py <args>`

## Command line arguments

-   -i, input app apk
-   -instr, path to json file containing high-level instructions generated by GAPS
-   -frida, use Frida to receive a Proof-of-Reachability when target method is executed

## Example usage

`python3 gaps_run.py -i <app_path> -instr <path_to_json> -frida`
